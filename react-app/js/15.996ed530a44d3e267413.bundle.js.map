{"version":3,"sources":["webpack:///./src/pages/Reversi/tools.tsx","webpack:///./src/pages/Reversi/index.tsx"],"names":["directionMap","statusMap","check","x","y","checkerboard","player","direction","dx","dy","result","click","couldClick","some","clickToCover","reverse","forEach","cx","cy","push","c","r","props","reset","e","state","history","step","size","setState","initCheckerboard","flatten","length","arr","reduce","a","b","concat","Array","isArray","itemMouseEnter","rowIndex","itemIndex","blackHover","whiteHover","itemMouseLeave","itemClick","black","white","curr","pass","retract","empty","renderItem","item","status","className","key","onClick","handle","onMouseOver","onMouseLeave","join","renderRow","row","map","getScore","isWin","content","title","info","render","isMobile","disablePass","Object","keys","this","type","disabled","Component","connect","component","Reversi","mapStateToProps","common"],"mappings":"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","file":"js/15.996ed530a44d3e267413.bundle.js","sourcesContent":["const directionMap = [\n  [0, 1],\n  [0, -1],\n  [-1, 0],\n  [1, 0],\n  [-1, -1],\n  [-1, 1],\n  [1, -1],\n  [1, 1]\n]\n\nconst statusMap = {\n  empty: 0,\n  black: 1,\n  white: 2\n}\n\nconst borderMax = 7\n\ninterface IReverse {\n  x: number;\n  y: number;\n}\n\nconst check = ({ x, y, checkerboard, player, direction }) => {\n  const [dx, dy] = direction\n  let result = 0\n  let click = player ? statusMap.black : statusMap.white\n  x += dx\n  y += dy\n  while (x >= 0 && x <= borderMax && y >= 0 && y <= borderMax) {\n    if (checkerboard[x][y] === statusMap.empty || result === 2) {\n      break\n    }\n    if (checkerboard[x][y] === click) {\n      result++\n      click = !player ? statusMap.black : statusMap.white\n    } else {\n      if (result !== 1) {\n        break\n      }\n    }\n    x += dx\n    y += dy\n  }\n  return result === 2\n}\n\nexport default {\n  couldClick: ({ x, y, checkerboard, player }) =>\n    directionMap.some(direction =>\n      check({ x, y, checkerboard, player, direction })\n    ),\n\n  clickToCover: ({ x, y, checkerboard, player }) => {\n    const reverse: IReverse[] = []\n    directionMap.forEach(direction => {\n      const [dx, dy] = direction\n      let cx = x\n      let cy = y\n      cx += dx\n      cy += dy\n      if (check({ x, y, checkerboard, player, direction })) {\n        while (cx >= 0 && cx <= borderMax && cy >= 0 && cy <= borderMax) {\n          if (\n            checkerboard[cx][cy] === statusMap.empty ||\n            checkerboard[cx][cy] ===\n              (player ? statusMap.white : statusMap.black)\n          ) {\n            break\n          }\n          checkerboard[cx][cy] = player ? statusMap.white : statusMap.black\n          reverse.push({ x: cx, y: cy })\n          cx += dx\n          cy += dy\n        }\n      }\n    })\n    return { c: checkerboard, r: reverse }\n  }\n}\n","import Utils from '@utils'\nimport { Button, Modal } from 'antd'\nimport React from 'react'\nimport './index.less'\nimport Tools from './tools'\n\ninterface IProps {\n  isMobile: boolean;\n}\n\ninterface IState {\n  checkerboard: any[][];\n  step: number;\n  history: any[];\n  size: number;\n}\n\nconst statusMap = {\n  empty: 0,\n  black: 1,\n  white: 2,\n  blackHover: 3,\n  whiteHover: 4\n}\n\nclass Reversi extends React.Component<IProps, IState> {\n  constructor(props) {\n    super(props)\n    this.reset()\n  }\n\n  reset = (e?) => {\n    const { checkerboard, size } = this.initCheckerboard()\n    const state = {\n      checkerboard,\n      history: [],\n      step: 0,\n      size\n    }\n    if (e) {\n      this.setState(state)\n    } else {\n      this.state = { ...state }\n    }\n  }\n\n  initCheckerboard = () => {\n    const checkerboard = [\n      [0, 0, 0, 0, 0, 0, 0, 0],\n      [0, 0, 0, 0, 0, 0, 0, 0],\n      [0, 0, 0, 0, 0, 0, 0, 0],\n      [0, 0, 0, 2, 1, 0, 0, 0],\n      [0, 0, 0, 1, 2, 0, 0, 0],\n      [0, 0, 0, 0, 0, 0, 0, 0],\n      [0, 0, 0, 0, 0, 0, 0, 0],\n      [0, 0, 0, 0, 0, 0, 0, 0]\n    ]\n    return {\n      checkerboard,\n      size: this.flatten(checkerboard).length\n    }\n  }\n\n  flatten = arr =>\n    arr.reduce((a, b) => a.concat(Array.isArray(b) ? this.flatten(b) : b), [])\n\n  couldClick = ({ x, y }) => {\n    const { checkerboard, step } = this.state\n    return Tools.couldClick({ x, y, checkerboard, player: step % 2 })\n  }\n\n  itemMouseEnter = ({ rowIndex: x, itemIndex: y }) => {\n    const { checkerboard, step } = this.state\n    const { blackHover, whiteHover } = statusMap\n    if (checkerboard[x][y] === statusMap.empty && this.couldClick({ x, y })) {\n      checkerboard[x][y] = step % 2 === 0 ? blackHover : whiteHover\n      this.setState({ checkerboard })\n    }\n  }\n\n  itemMouseLeave = ({ rowIndex: x, itemIndex: y }) => {\n    const { checkerboard } = this.state\n    if (\n      checkerboard[x][y] === statusMap.blackHover ||\n      checkerboard[x][y] === statusMap.whiteHover\n    ) {\n      checkerboard[x][y] = statusMap.empty\n      this.setState({ checkerboard })\n    }\n  }\n\n  itemClick = ({ rowIndex: x, itemIndex: y }) => {\n    const { checkerboard, step, history } = this.state\n    const { black, white } = statusMap\n    if (\n      checkerboard[x][y] !== black &&\n      checkerboard[x][y] !== white &&\n      this.couldClick({ x, y })\n    ) {\n      checkerboard[x][y] = step % 2 === 0 ? black : white\n      const { c, r } = Tools.clickToCover({\n        x,\n        y,\n        checkerboard,\n        player: step % 2\n      })\n      history.push({ curr: { x, y }, reverse: r })\n      this.setState({\n        checkerboard: c,\n        step: history.length,\n        history\n      })\n    }\n  }\n\n  pass = () => {\n    const { history } = this.state\n    history.push({})\n    this.setState({\n      step: history.length,\n      history\n    })\n  }\n\n  retract = () => {\n    const { history, checkerboard } = this.state\n    const { curr, reverse } = history.pop()\n    if (curr) {\n      const { x, y } = curr\n      const { empty, black, white } = statusMap\n      checkerboard[x][y] = empty\n      reverse.forEach(r => {\n        checkerboard[r.x][r.y] =\n          checkerboard[r.x][r.y] === white ? black : white\n      })\n    }\n\n    this.setState({ history, step: history.length, checkerboard })\n  }\n\n  renderItem = (item, rowIndex, itemIndex) => {\n    const status = this.state.checkerboard[rowIndex][itemIndex]\n    const { black, white, blackHover, whiteHover } = statusMap\n    const className = status ? ['chosen'] : []\n    if (className.length) {\n      switch (status) {\n        case black:\n          className.push('black selected')\n          break\n        case white:\n          className.push('white selected')\n          break\n        case blackHover:\n          className.push('black')\n          break\n        case whiteHover:\n          className.push('white')\n          break\n      }\n    }\n    return (\n      <td\n        className=\"item\"\n        key={itemIndex}\n        onClick={Utils.handle(this.itemClick, { rowIndex, itemIndex })}\n        onMouseOver={Utils.handle(this.itemMouseEnter, { rowIndex, itemIndex })}\n        onMouseLeave={Utils.handle(this.itemMouseLeave, {\n          rowIndex,\n          itemIndex\n        })}\n      >\n        <div className={className.join(' ')}>\n          <div className=\"chess front\" />\n          <div className=\"chess back\" />\n        </div>\n      </td>\n    )\n  }\n\n  renderRow = (row, rowIndex) => (\n    <tr className=\"row\" key={rowIndex}>\n      {row.map((item, itemIndex) => this.renderItem(item, rowIndex, itemIndex))}\n    </tr>\n  )\n\n  getScore = () => {\n    const { checkerboard } = this.state\n    let black = 0\n    let white = 0\n    checkerboard.forEach(row =>\n      row.forEach(item => {\n        if (item === statusMap.black) {\n          black++\n        }\n        if (item === statusMap.white) {\n          white++\n        }\n      })\n    )\n    return { black, white }\n  }\n\n  isWin = ({ black, white, size }) => {\n    let title = ''\n    let content\n    if (black + white === size) {\n      if (black > white) {\n        title = 'Victory'\n        content = 'black wins'\n      } else if (black < white) {\n        title = 'Victory'\n        content = 'white wins'\n      } else {\n        title = 'Peace'\n        content = 'Draw'\n      }\n    } else if (!black || !white) {\n      if (black) {\n        title = 'Victory'\n        content = 'black wins'\n      } else if (white) {\n        title = 'Victory'\n        content = 'white wins'\n      }\n    }\n\n    if (title && content) {\n      Modal.info({ title, content })\n    }\n  }\n\n  render() {\n    const { checkerboard, history, step, size } = this.state\n    const { isMobile } = this.props\n    const { black, white } = this.getScore()\n    const disablePass =\n      black + white === size ||\n      (history.length && Object.keys(history[history.length - 1]).length === 0)\n    this.isWin({ black, white, size })\n    return (\n      <div className=\"reversi-wrapper\">\n        <div className=\"reversi-top\">\n          <div\n            className={`top black ${isMobile ? '' : 'bigger'} ${\n              step % 2 === 1 ? '' : 'current'\n            }`}\n          >\n            {black}\n          </div>\n          <div\n            className={`top white ${isMobile ? '' : 'bigger'} ${\n              step % 2 === 1 ? 'current' : ''\n            }`}\n          >\n            {white}\n          </div>\n        </div>\n        <div className={isMobile ? 'checkerboard' : 'checkerboard bigger'}>\n          <table>\n            <tbody>{checkerboard.map(this.renderRow)}</tbody>\n          </table>\n        </div>\n        <div className=\"reversi-bottom\">\n          <Button\n            type=\"primary\"\n            disabled={history.length === 0}\n            onClick={this.reset}\n          >\n            Reset\n          </Button>\n          <Button\n            type=\"primary\"\n            disabled={disablePass ? true : false}\n            onClick={this.pass}\n          >\n            Pass\n          </Button>\n          <Button\n            type=\"primary\"\n            disabled={history.length === 0}\n            onClick={this.retract}\n          >\n            Retract\n          </Button>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Utils.connect({\n  component: Reversi,\n  mapStateToProps: state => ({\n    isMobile: state.common.isMobile\n  })\n})\n"],"sourceRoot":""}