{"version":3,"sources":["webpack:///./src/pages/2048/tools.tsx","webpack:///./node_modules/css-animation/lib/Event.js","webpack:///./src/constant/common.ts","webpack:///./src/pages/2048/index.tsx"],"names":["__webpack_require__","r","__webpack_exports__","getValue","x","y","p","res","v","index","some","i","same","moveRight","changed","max","curr","occupied","_a","currV","currIndex","_b","nextV","nextIndex","merged","push","id","Math","random","moveLeft","min","moveDown","moveUp","Object","defineProperty","exports","value","START_EVENT_NAME_MAP","transitionstart","transition","WebkitTransition","MozTransition","OTransition","msTransition","animationstart","animation","WebkitAnimation","MozAnimation","OAnimation","msAnimation","END_EVENT_NAME_MAP","transitionend","animationend","startEvents","endEvents","addEventListener","node","eventName","eventListener","removeEventListener","window","document","style","createElement","process","EVENT_NAME_MAP","events","baseEventName","hasOwnProperty","baseEvents","styleName","detectEvents","TransitionEvents","addStartEventListener","length","forEach","startEvent","setTimeout","removeStartEventListener","addEndEventListener","endEvent","removeEndEventListener","module","keyCode","left","up","right","down","storage","_utils__WEBPACK_IMPORTED_MODULE_0__","Storage","_constant_common__WEBPACK_IMPORTED_MODULE_10__","Page2048","_super","_this","apply","this","arguments","reset","pieces","isArray","addRandom","set","setState","size","cached","removeMerged","f","state","filter","touchstart","e","changedTouches","pageX","pageY","touchmove","preventDefault","touchend","sx","sy","ex","ey","code","abs","doMove","keydown","_tools__WEBPACK_IMPORTED_MODULE_9__","dp","_c","lp","_d","rp","isReset","setStorage","doAddRandom","clone","item","get4or2","renderGrid","Array","fill","map","v1","react__WEBPACK_IMPORTED_MODULE_7__","className","key","v2","isGameOver","list","canMove","data","c","__extends","prototype","componentWillMount","get","componentDidMount","componentWillUnmount","render","antd_lib_icon__WEBPACK_IMPORTED_MODULE_3___default","a","type","antd_lib_popconfirm__WEBPACK_IMPORTED_MODULE_5___default","title","onConfirm","handle","okText","cancelText","antd_lib_button__WEBPACK_IMPORTED_MODULE_1___default"],"mappings":"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","file":"js/10.4990b689fe0b314b5171.bundle.js","sourcesContent":["interface IPiece {\n  x: number,\n  y: number,\n  v: number,\n  merged?: boolean,\n  id: number\n}\n\nconst getValue = (x, y, p) => {\n  let res = { v: 0, index: -1 }\n  p.some((i, index) => {\n    const same = i.x === x && i.y === y\n    if (same) { res = { v: i.v, index } }\n    return same\n  })\n  return res\n}\n\nexport default {\n  moveRight: (p: IPiece[]) => {\n    let changed = false\n    for (let y = 0; y < 4; y++) {\n      let max = 3\n      for (let x = 2; x >= 0; x--) {\n        let curr = -1\n        const isOccupied = p.some((i, index) => {\n          const occupied = i.x === (x + 1) && i.y === y\n          if (i.x === x && i.y === y) { curr = index }\n          if (occupied) { max-- }\n          return occupied\n        })\n        if (!isOccupied && curr >= 0) {\n          p[curr].x = max\n          changed = true\n          max--\n        }\n      }\n      for (let x = 2; x >= 0; x--) {\n        const { v: currV, index: currIndex } = getValue(x, y, p)\n        const { v: nextV, index: nextIndex } = getValue(x + 1, y, p)\n        if (currV && nextV && currV === nextV) {\n          p[currIndex].x = x + 1\n          p[currIndex].merged = true\n          p[nextIndex].merged = true\n          for (let v = x - 1; v >= 0; v--) {\n            const { index: i } = getValue(v, y, p)\n            if (i >= 0) { p[i].x = p[i].x < 3 ? p[i].x + 1 : p[i].x }\n          }\n          p.push({ x: x + 1, y, v: currV * 2, id: Math.random() })\n          changed = true\n        }\n      }\n    }\n    return { p, changed }\n  },\n\n  moveLeft: (p: IPiece[]) => {\n    let changed = false\n    for (let y = 0; y < 4; y++) {\n      let min = 0\n      for (let x = 1; x < 4; x++) {\n        let curr = -1\n        const isOccupied = p.some((i, index) => {\n          const occupied = i.x === (x - 1) && i.y === y\n          if (i.x === x && i.y === y) { curr = index }\n          if (occupied) { min++ }\n          return occupied\n        })\n        if (!isOccupied && curr >= 0) {\n          p[curr].x = min\n          changed = true\n          min++\n        }\n      }\n      for (let x = 1; x < 4; x++) {\n        const { v: currV, index: currIndex } = getValue(x, y, p)\n        const { v: nextV, index: nextIndex } = getValue(x - 1, y, p)\n        if (currV && nextV && currV === nextV) {\n          p[currIndex].x = x - 1\n          p[currIndex].merged = true\n          p[nextIndex].merged = true\n          for (let v = x; v <= 3; v++) {\n            const { index: i } = getValue(v, y, p)\n            if (i >= 0) { p[i].x = p[i].x > 0 ? p[i].x - 1 : p[i].x }\n          }\n          p.push({ x: x - 1, y, v: currV * 2, id: Math.random() })\n          changed = true\n        }\n      }\n    }\n    return { p, changed }\n  },\n\n  moveDown: (p: IPiece[]) => {\n    let changed = false\n    for (let x = 0; x < 4; x++) {\n      let max = 3\n      for (let y = 2; y >= 0; y--) {\n        let curr = -1\n        const isOccupied = p.some((i, index) => {\n          const occupied = i.x === x && i.y === (y + 1)\n          if (i.x === x && i.y === y) { curr = index }\n          if (occupied) { max-- }\n          return occupied\n        })\n        if (!isOccupied && curr >= 0) {\n          p[curr].y = max\n          changed = true\n          max--\n        }\n      }\n      for (let y = 2; y >= 0; y--) {\n        const { v: currV, index: currIndex } = getValue(x, y, p)\n        const { v: nextV, index: nextIndex } = getValue(x, y + 1, p)\n        if (currV && nextV && currV === nextV) {\n          p[currIndex].y = y + 1\n          p[currIndex].merged = true\n          p[nextIndex].merged = true\n          for (let v = y - 1; v >= 0; v--) {\n            const { index: i } = getValue(x, v, p)\n            if (i >= 0) { p[i].y = p[i].y < 3 ? p[i].y + 1 : p[i].y }\n          }\n          p.push({ x, y: y + 1, v: currV * 2, id: Math.random() })\n          changed = true\n        }\n      }\n    }\n    return { p, changed }\n  },\n\n  moveUp: (p: IPiece[]) => {\n    let changed = false\n    for (let x = 0; x < 4; x++) {\n      let min = 0\n      for (let y = 1; y < 4; y++) {\n        let curr = -1\n        const isOccupied = p.some((i, index) => {\n          const occupied = i.x === x && i.y === (y - 1)\n          if (i.x === x && i.y === y) { curr = index }\n          if (occupied) { min++ }\n          return occupied\n        })\n        if (!isOccupied && curr >= 0) {\n          p[curr].y = min\n          changed = true\n          min++\n        }\n      }\n      for (let y = 1; y < 4; y++) {\n        const { v: currV, index: currIndex } = getValue(x, y, p)\n        const { v: nextV, index: nextIndex } = getValue(x, y - 1, p)\n        if (currV && nextV && currV === nextV) {\n          p[currIndex].y = y - 1\n          p[currIndex].merged = true\n          p[nextIndex].merged = true\n          for (let v = y; v <= 3; v++) {\n            const { index: i } = getValue(x, v, p)\n            if (i >= 0) { p[i].y = p[i].y > 0 ? p[i].y - 1 : p[i].y }\n          }\n          p.push({ x, y: y - 1, v: currV * 2, id: Math.random() })\n          changed = true\n        }\n      }\n    }\n    return { p, changed }\n  }\n}\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar START_EVENT_NAME_MAP = {\n  transitionstart: {\n    transition: 'transitionstart',\n    WebkitTransition: 'webkitTransitionStart',\n    MozTransition: 'mozTransitionStart',\n    OTransition: 'oTransitionStart',\n    msTransition: 'MSTransitionStart'\n  },\n\n  animationstart: {\n    animation: 'animationstart',\n    WebkitAnimation: 'webkitAnimationStart',\n    MozAnimation: 'mozAnimationStart',\n    OAnimation: 'oAnimationStart',\n    msAnimation: 'MSAnimationStart'\n  }\n};\n\nvar END_EVENT_NAME_MAP = {\n  transitionend: {\n    transition: 'transitionend',\n    WebkitTransition: 'webkitTransitionEnd',\n    MozTransition: 'mozTransitionEnd',\n    OTransition: 'oTransitionEnd',\n    msTransition: 'MSTransitionEnd'\n  },\n\n  animationend: {\n    animation: 'animationend',\n    WebkitAnimation: 'webkitAnimationEnd',\n    MozAnimation: 'mozAnimationEnd',\n    OAnimation: 'oAnimationEnd',\n    msAnimation: 'MSAnimationEnd'\n  }\n};\n\nvar startEvents = [];\nvar endEvents = [];\n\nfunction detectEvents() {\n  var testEl = document.createElement('div');\n  var style = testEl.style;\n\n  if (!('AnimationEvent' in window)) {\n    delete START_EVENT_NAME_MAP.animationstart.animation;\n    delete END_EVENT_NAME_MAP.animationend.animation;\n  }\n\n  if (!('TransitionEvent' in window)) {\n    delete START_EVENT_NAME_MAP.transitionstart.transition;\n    delete END_EVENT_NAME_MAP.transitionend.transition;\n  }\n\n  function process(EVENT_NAME_MAP, events) {\n    for (var baseEventName in EVENT_NAME_MAP) {\n      if (EVENT_NAME_MAP.hasOwnProperty(baseEventName)) {\n        var baseEvents = EVENT_NAME_MAP[baseEventName];\n        for (var styleName in baseEvents) {\n          if (styleName in style) {\n            events.push(baseEvents[styleName]);\n            break;\n          }\n        }\n      }\n    }\n  }\n\n  process(START_EVENT_NAME_MAP, startEvents);\n  process(END_EVENT_NAME_MAP, endEvents);\n}\n\nif (typeof window !== 'undefined' && typeof document !== 'undefined') {\n  detectEvents();\n}\n\nfunction addEventListener(node, eventName, eventListener) {\n  node.addEventListener(eventName, eventListener, false);\n}\n\nfunction removeEventListener(node, eventName, eventListener) {\n  node.removeEventListener(eventName, eventListener, false);\n}\n\nvar TransitionEvents = {\n  // Start events\n  startEvents: startEvents,\n\n  addStartEventListener: function addStartEventListener(node, eventListener) {\n    if (startEvents.length === 0) {\n      window.setTimeout(eventListener, 0);\n      return;\n    }\n    startEvents.forEach(function (startEvent) {\n      addEventListener(node, startEvent, eventListener);\n    });\n  },\n  removeStartEventListener: function removeStartEventListener(node, eventListener) {\n    if (startEvents.length === 0) {\n      return;\n    }\n    startEvents.forEach(function (startEvent) {\n      removeEventListener(node, startEvent, eventListener);\n    });\n  },\n\n\n  // End events\n  endEvents: endEvents,\n\n  addEndEventListener: function addEndEventListener(node, eventListener) {\n    if (endEvents.length === 0) {\n      window.setTimeout(eventListener, 0);\n      return;\n    }\n    endEvents.forEach(function (endEvent) {\n      addEventListener(node, endEvent, eventListener);\n    });\n  },\n  removeEndEventListener: function removeEndEventListener(node, eventListener) {\n    if (endEvents.length === 0) {\n      return;\n    }\n    endEvents.forEach(function (endEvent) {\n      removeEventListener(node, endEvent, eventListener);\n    });\n  }\n};\n\nexports['default'] = TransitionEvents;\nmodule.exports = exports['default'];","export default {\n  keyCode: {\n    left: 37,\n    up: 38,\n    right: 39,\n    down: 40\n  }\n}\n","import Utils from '@utils'\nimport { Button, Icon, Popconfirm } from 'antd'\nimport * as React from 'react'\nimport './index.less'\nimport Tools from './tools'\nimport common from '@constant/common'\nconst storage = new Utils.Storage('2048')\nconst { keyCode } = common\n\ninterface IPiece {\n  x: number,\n  y: number,\n  v: number,\n  id: number,\n  merged?: boolean\n}\n\ninterface IState {\n  size: number,\n  pieces: IPiece[],\n  cached: {\n    x: number,\n    y: number\n  }\n}\n\ninterface IProp {\n  isMobile: boolean\n}\n\nclass Page2048 extends React.Component<IProp, IState> {\n\n  componentWillMount () {\n    this.reset(storage.get('pieces'))\n    document.addEventListener('keydown', this.keydown)\n  }\n\n  reset = pieces => {\n    if (!Utils.isArray(pieces)) {\n      pieces = []\n      this.addRandom(pieces, true)\n      this.addRandom(pieces, true)\n      storage.set('pieces', null)\n    }\n    this.setState({\n      size: 4,\n      pieces,\n      cached: { x: 0, y: 0 }\n    })\n  }\n\n  componentDidMount () {\n    document.addEventListener('touchstart', this.touchstart)\n    document.addEventListener('touchmove', this.touchmove)\n    document.addEventListener('touchend', this.touchend)\n  }\n\n  componentWillUnmount () {\n    document.removeEventListener('keydown', this.keydown)\n    document.removeEventListener('touchstart', this.touchstart)\n    document.removeEventListener('touchmove', this.touchmove)\n    document.removeEventListener('touchend', this.touchend)\n  }\n\n  removeMerged = f => {\n    const { pieces: p } = this.state\n    const pieces = p.filter(i => !i.merged)\n    this.setState({ pieces }, f)\n  }\n\n  touchstart = e => {\n    const { pageX, pageY } = e.changedTouches[0]\n    this.setState({ cached: { x: pageX, y: pageY } })\n  }\n\n  touchmove = e => e.preventDefault()\n\n  touchend = e => {\n    const { x: sx, y: sy } = this.state.cached\n    const { pageX : ex, pageY: ey } = e.changedTouches[0]\n    let code = 0\n    if (Math.abs(sx - ex) > Math.abs(sy - ey) && Math.abs(sx - ex) > 20) {\n      code = sx - ex > 0 ? keyCode.left : keyCode.right\n    } else if (Math.abs(sx - ex) < Math.abs(sy - ey) && Math.abs(sy - ey) > 20) {\n      code = sy - ey > 0 ? keyCode.up : keyCode.down\n    } else {\n      return\n    }\n    this.doMove(code)\n  }\n\n  keydown = e => this.doMove(e.keyCode)\n\n  doMove = code => {\n    this.removeMerged(() => {\n      const { pieces } = this.state\n      let p: IPiece[] = pieces\n      switch (code) {\n        case keyCode.up:\n          const { p: up, changed: uc } = Tools.moveUp(pieces)\n          if (uc) { p = this.addRandom(up) }\n          break\n        case keyCode.down:\n          const { p: dp, changed: dc } = Tools.moveDown(pieces)\n          if (dc) { p = this.addRandom(dp) }\n          break\n        case keyCode.left:\n          const { p: lp, changed: lc } = Tools.moveLeft(pieces)\n          if (lc) { p = this.addRandom(lp) }\n          break\n        case keyCode.right:\n          const { p: rp, changed: rc } = Tools.moveRight(pieces)\n          if (rc) { p = this.addRandom(rp) }\n          break\n      }\n      this.setState({ pieces: p })\n    })\n  }\n\n  addRandom = (p, isReset?) => {\n    if (!isReset) { setTimeout(() => this.setStorage(p), 0) }\n    const i = this.doAddRandom(p)\n    if (i) { p.push(i) }\n    return p\n  }\n\n  setStorage = p => {\n    storage.set('pieces', Utils.clone(p).filter((item, i) => {\n      item.id = i\n      return !item.merged\n    }))\n  }\n\n  doAddRandom = p => {\n    if (p.length === 16) { return null }\n    const x = Utils.random(0, 4)\n    const y = Utils.random(0, 4)\n    return p.some(i => i.x === x && i.y === y)\n      ? this.doAddRandom(p)\n      : { x, y, v: this.get4or2(), id: Math.random() }\n  }\n\n  get4or2 = () => Math.random() > .9 ? 4 : 2\n\n  renderGrid = () => new Array(this.state.size).fill(null).map((v1, x) => (\n    <div className='row' key={x}>\n      {\n        new Array(this.state.size).fill(null).map((v2, y) => (\n          <div className='item' key={y}/>\n        ))\n      }\n    </div>\n  ))\n\n  isGameOver = pieces => {\n    const { size } = this.state\n    if (pieces.filter(p => !p.merged).length !== size * size) {\n      return false\n    }\n\n    const list: number[][] = [\n      [0, 0, 0, 0],\n      [0, 0, 0, 0],\n      [0, 0, 0, 0],\n      [0, 0, 0, 0]\n    ]\n\n    pieces.forEach(({ x, y, v }) => list[x][y] = v)\n\n    return this.canMove(list)\n  }\n\n  canMove = data => {\n    for (let r = 0; r < data.length; r++) {\n      for (let c = 0; c < data[r].length; c++) {\n        if (data[r][c] === 0) {\n          return false\n        } else if (c < data[r].length - 1\n          && data[r][c] === data[r][c + 1]) {\n          return false\n        } else if (r < data.length - 1\n          && data[r][c] === data[r + 1][c]) {\n          return false\n        }\n      }\n    }\n    return true\n  }\n\n  render () {\n    const { pieces } = this.state\n    return (\n      <div className='game2048-wrapper'>\n        <div className='game2048-container' >\n          <div className='grid'>\n            { this.renderGrid() }\n          </div>\n          <div className='piece-contanier'>\n            {\n              (pieces || []).map(item => (\n                <div className={`piece piece-${item.v} piece-position-${item.x}-${item.y} ${item.merged ? 'merged' : ''}`} key={item.id} >\n                  <div className='item'>\n                    {\n                      item.v === 2048\n                        ? <Icon type='ts-app icon-batman' />\n                        : item.v\n                    }\n                  </div>\n                </div>\n              ))\n            }\n          </div>\n          <div className={this.isGameOver(pieces) ? 'mask' : 'mask hidden'}>\n            Game Over\n          </div>\n        </div>\n        <div className='btn-container'>\n          <Popconfirm title='Sure about that?' onConfirm={Utils.handle(this.reset)} okText='Yes' cancelText='No'>\n            <Button type='primary' className='reset-btn'>\n              Reset\n            </Button>\n          </Popconfirm>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Page2048\n"],"sourceRoot":""}