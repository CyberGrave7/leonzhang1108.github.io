{"version":3,"sources":["webpack:///./src/pages/Gobang/index.tsx"],"names":["Gobang","_super","_this","apply","this","arguments","reset","size","props","isMobile","renju","setState","showNumber","step","positions","checkerboard","calculateCheckerboard","result","i","row","j","push","state","index","mouseEnter","_a","rowIndex","itemIndex","setCheckerboard","mouseLeave","itemClick","isClick","_b","p","concat","column","isWin","isPeace","antd_lib_modal__WEBPACK_IMPORTED_MODULE_3___default","a","info","title","content","isColumnWin","isRowWin","isSkewWin","isDownLineWin","isUpLineWin","toggleShowNumber","retract","pop","renderItem","item","className","react__WEBPACK_IMPORTED_MODULE_5__","key","onClick","_utils__WEBPACK_IMPORTED_MODULE_0__","handle","onMouseEnter","onMouseLeave","renderRow","map","__extends","prototype","componentWillMount","render","antd_lib_button__WEBPACK_IMPORTED_MODULE_1___default","type","disabled","length","__webpack_exports__","connect","component","mapStateToProps","common"],"mappings":"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","file":"js/22.01c80f22b32e0766a328.bundle.js","sourcesContent":["import Utils from '@utils'\nimport { Button, Modal } from 'antd'\nimport * as React from 'react'\nimport './index.less'\n\ninterface IProps {\n  isMobile: boolean\n}\n\ninterface IState {\n  size: number,\n  showNumber: boolean,\n  checkerboard: any[][],\n  step: number,\n  positions: any[]\n  renju: number\n}\n\nclass Gobang extends React.Component<IProps, IState> {\n  componentWillMount () {\n    this.reset()\n  }\n\n  reset = () => {\n    const size = !this.props.isMobile ? 15 : 3\n    const renju = !this.props.isMobile ? 5 : 3\n    this.setState({\n      size, renju,\n      showNumber: false,\n      step: 0,\n      positions: [],\n      checkerboard: this.calculateCheckerboard(size)\n    })\n  }\n\n  // state\n  // 0: nothing, 1: hover, 2: black, 3: white\n  calculateCheckerboard = size => {\n    const result: any[][] = []\n    for (let i = 0; i < size; i++) {\n      const row: any[] = []\n      for (let j = 0; j < size; j++) {\n        row.push({ state: 0, index: -1 })\n      }\n      result.push(row)\n    }\n    return result\n  }\n\n  mouseEnter = ({ rowIndex, itemIndex }) => {\n    this.setCheckerboard({ state: 1, rowIndex, itemIndex })\n  }\n\n  mouseLeave = ({ rowIndex, itemIndex }) => {\n    this.setCheckerboard({ state: 0, rowIndex, itemIndex })\n  }\n\n  itemClick = ({ rowIndex, itemIndex }) => {\n    const { step } = this.state\n    this.setCheckerboard({ state: step % 2 === 1 ? 3 : 2, rowIndex, itemIndex }, true)\n  }\n\n  setCheckerboard = ({ state, rowIndex, itemIndex }, isClick?) => {\n    const { checkerboard, step, positions: p } = this.state\n    if (checkerboard[rowIndex][itemIndex].state !== 2 && checkerboard[rowIndex][itemIndex].state !== 3) {\n      checkerboard[rowIndex][itemIndex] = { state, index: isClick ? step : -1 }\n      this.setState({\n        checkerboard,\n        step: isClick ? step + 1 : step,\n        positions: isClick ? p.concat({ row: rowIndex, column: itemIndex }) : p\n      }, () => isClick && !this.isWin({ rowIndex, itemIndex, state }) && this.isPeace())\n    }\n  }\n\n  isPeace = () => {\n    const { size, step } = this.state\n    if (size * size === step) {\n      Modal.info({\n        title: 'Peace',\n        content: 'Draw'\n      })\n    }\n  }\n\n  isWin = ({ rowIndex, itemIndex, state }) => {\n    const isWin = this.isColumnWin({ rowIndex, itemIndex, state })\n      || this.isRowWin({ rowIndex, itemIndex, state })\n      || this.isSkewWin({ rowIndex, itemIndex, state })\n\n    if (isWin) {\n      Modal.info({\n        title: 'Victory',\n        content: `${state === 2 ? 'black' : 'white'} wins`\n      })\n    }\n    return isWin\n  }\n\n  isColumnWin = ({ rowIndex, itemIndex, state }) => {\n    const { size, checkerboard, renju } = this.state\n    let result = 0\n    for (let i = -(renju - 1); i <= renju - 1; i++) {\n      if (rowIndex + i >= 0\n        && rowIndex + i < size\n        && checkerboard[rowIndex + i][itemIndex].state === state\n      ) {\n        result++\n      } else {\n        result = 0\n      }\n      if (result === renju) {\n        break\n      }\n    }\n    return result === renju\n  }\n\n  isRowWin = ({ rowIndex, itemIndex, state }) => {\n    const { size, checkerboard, renju } = this.state\n    let result = 0\n    for (let i = -(renju - 1); i <= renju - 1; i++) {\n      if (itemIndex + i >= 0\n        && itemIndex + i < size\n        && checkerboard[rowIndex][itemIndex + i].state === state\n      ) {\n        result++\n      } else {\n        result = 0\n      }\n      if (result === renju) {\n        break\n      }\n    }\n    return result === renju\n  }\n\n  isSkewWin = ({ rowIndex, itemIndex, state }) =>\n    this.isDownLineWin({ rowIndex, itemIndex, state })\n      || this.isUpLineWin({ rowIndex, itemIndex, state })\n\n  isDownLineWin = ({ rowIndex, itemIndex, state }) => {\n    const { size, checkerboard, renju } = this.state\n    let result = 0\n    for (let i = -(renju - 1); i <= renju - 1; i++) {\n      if (itemIndex + i >= 0\n        && itemIndex + i < size\n        && rowIndex + i >= 0\n        && rowIndex + i < size\n        && checkerboard[rowIndex + i][itemIndex + i].state === state\n      ) {\n        result++\n      } else {\n        result = 0\n      }\n      if (result === renju) {\n        break\n      }\n    }\n    return result === renju\n  }\n\n  isUpLineWin = ({ rowIndex, itemIndex, state }) => {\n    const { size, checkerboard, renju } = this.state\n    let result = 0\n    for (let i = -(renju - 1); i <= renju - 1; i++) {\n      if (itemIndex + i >= 0\n        && itemIndex + i < size\n        && rowIndex - i >= 0\n        && rowIndex - i < size\n        && checkerboard[rowIndex - i][itemIndex + i].state === state\n      ) {\n        result++\n      } else {\n        result = 0\n      }\n      if (result === renju) {\n        break\n      }\n    }\n    return result === renju\n  }\n\n  toggleShowNumber = () => {\n    this.setState({ showNumber: !this.state.showNumber })\n  }\n\n  retract = () => {\n    const { step, positions, checkerboard } = this.state\n    const { row, column } = positions.pop()\n    checkerboard[row][column] = { state: 0, index: -1 }\n    this.setState({\n      step: step - 1,\n      positions,\n      checkerboard\n    })\n  }\n\n  renderItem = (item, rowIndex, itemIndex) => {\n    const { state, index } = item\n    const { step, showNumber } = this.state\n    let className = ''\n    switch (state) {\n      case 1:\n        className = step % 2 !== 1 ? 'chosen black' : 'chosen white'\n        break\n      case 2:\n        className = 'chosen black selected'\n        break\n      case 3:\n        className = 'chosen white selected'\n        break\n    }\n    return (\n      <td className='item' key={itemIndex}\n        onClick={Utils.handle(this.itemClick, { rowIndex, itemIndex })}\n        onMouseEnter={Utils.handle(this.mouseEnter, { rowIndex, itemIndex })}\n        onMouseLeave={Utils.handle(this.mouseLeave, { rowIndex, itemIndex })}\n      >\n        <div className={className}>{showNumber && index >= 0 ? index + 1 : ''}</div>\n      </td>\n    )\n  }\n\n  renderRow = (row, rowIndex) => (\n    <tr className='row' key={rowIndex}>\n      { row.map((item, itemIndex) => this.renderItem(item, rowIndex, itemIndex)) }\n    </tr>\n  )\n\n  render () {\n    const { checkerboard, showNumber, positions } = this.state\n    return (\n      <div className='gobang-wrapper'>\n        <table>\n          <tbody>\n            { checkerboard.map(this.renderRow) }\n          </tbody>\n        </table>\n        <div className='button-wrapper'>\n          <Button type='primary' disabled={positions.length === 0} onClick={this.reset}>\n            Reset\n          </Button>\n          <Button type='primary' onClick={this.toggleShowNumber}>\n            { showNumber ? 'Hide steps' : 'Show steps'}\n          </Button>\n          <Button type='primary' disabled={positions.length === 0} onClick={this.retract}>\n            Retract\n          </Button>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Utils.connect({\n  component: Gobang,\n  mapStateToProps: state => ({\n    isMobile: state.common.isMobile\n  })\n})\n"],"sourceRoot":""}