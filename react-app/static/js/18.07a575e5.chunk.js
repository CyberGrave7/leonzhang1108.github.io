webpackJsonp([18],{151:function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t=function(){return function(e){var r=e.draw,n=e.size,t=e.volume,a=e.currentTime,o=this;this.initAC=function(){o.ac=new AudioContext,o.gainNode=o.ac.createGain(),o.gainNode.gain.value=o.volume,o.gainNode.connect(o.ac.destination),o.analyser=o.ac.createAnalyser(),o.analyser.fftSize=2*o.size,o.analyser.connect(o.gainNode)},this.load=function(e,r,n){o.xhr=new XMLHttpRequest,o.abort(),o.xhr.open("GET",e),o.xhr.responseType="arraybuffer",o.xhr.onload=function(){r(o.xhr.response)},o.xhr.onprogress=function(e){var r=e.loaded,t=e.total;n(r/t*100)},o.xhr.send()},this.abort=function(){return o.xhr&&o.xhr.abort()},this.play=function(e){var r=e.src,n=e.cb,t=e.progressCb,a=++o.count;o.source&&o.source.stop();var i=function(e){if(o.buffer=e,a===o.count&&o.ac)try{o.createBufferSource({buffer:e,cb:n})}catch(e){console.log(e)}};r instanceof ArrayBuffer?o.ac.decodeAudioData(r,i):o.load(r,function(e){o.ac.decodeAudioData(e,i)},t)},this.createBufferSource=function(e){var r=e.buffer,n=e.start,t=void 0===n?0:n,a=e.cb;if(o.source&&o.source.stop(),o.buffer){var i=o.ac.createBufferSource();i.buffer=o.buffer=r,i.loop=!0,i.connect(o.analyser),i.start(0,t),o.source=i,o.visualize(),a()}},this.updateVolume=function(e){o.gainNode.gain.value=o.volume=e},this.visualize=function(){var e=new Uint8Array(o.analyser.frequencyBinCount),r=window.requestAnimationFrame,n=o.buffer.duration,t=function(){o.analyser.getByteFrequencyData(e),o.draw(e,o.volume),o.rafId=r(t);var a=o.ac.currentTime.toFixed(0),i=n.toFixed(0);o.curr&&o.curr===a||(o.curr=a,o.currentTime({curr:a,total:i}))};t()},this.setCurrent=function(e){var r=o.buffer,n=console.log;o.initAC(),o.createBufferSource({buffer:r,start:e,cb:n})},this.pause=function(){o.ac.suspend(),window.cancelAnimationFrame(o.rafId)},this.resume=function(){o.ac.resume(),o.visualize()},this.stop=function(){o.abort(),o.ac.close(),window.cancelAnimationFrame(o.rafId)},this.source=null,this.count=0,this.draw=r,this.size=n,this.volume=t,this.currentTime=a,this.initAC()}}();r.default=t}});
//# sourceMappingURL=18.07a575e5.chunk.js.map