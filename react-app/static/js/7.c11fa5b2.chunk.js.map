{"version":3,"sources":["pages/Tetris/block.tsx","pages/Tetris/tools.tsx","webpack:///./src/pages/Tetris/index.less?8d99","pages/Tetris/index.less","pages/Tetris/index.tsx"],"names":["__webpack_exports__","L","J","O","T","Z","S","I","keyCode","couldMoveLeftOrRight","_a","width","block","rx","y","playboard","length","leftBlockList","couldMove","forEach","row","dy","every","item","dx","push","x","ox","oy","nx","ny","couldMoveFun","_","bottomBlockList","i","l","next","b","getCurrPosition","cBlock","screen","rotate","moveTo","__WEBPACK_IMPORTED_MODULE_0__utils__","clone","__WEBPACK_IMPORTED_MODULE_1__block__","max","center","Math","floor","index","cm","curr","content","__webpack_require__","module","options","hmr","transform","locals","exports","version","sources","names","mappings","file","sourcesContent","sourceRoot","left","up","right","down","blocks","Tetris","_super","_this","apply","this","arguments","reset","f","setState","__WEBPACK_IMPORTED_MODULE_2__utils__","random","clearRow","state","result","map","splice","unshift","Array","fill","keydown","e","doMove","code","cx","my","_b","__WEBPACK_IMPORTED_MODULE_3__tools__","lp","lx","_c","rp","newInterval","isDropComplete","r","_d","interval","clearInterval","doMovePlayboard","ix","iy","intervalTime","setInterval","movePlayboard","res","calculateScreen","c","column","j","renderPlayboard","__WEBPACK_IMPORTED_MODULE_0_react__","className","key","__extends","prototype","componentWillMount","document","addEventListener","componentDidMount","componentWillUnmount","removeEventListener","render","isMobile","props","__WEBPACK_IMPORTED_MODULE_4_antd_es_icon__","type","onClick","handle","connect","component","mapStateToProps","common"],"mappings":"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","file":"static/js/7.c11fa5b2.chunk.js","sourcesContent":["export default {\n  L: [\n    [\n      [0, 0, 1],\n      [1, 1, 1]\n    ], [\n      [1, 0],\n      [1, 0],\n      [1, 1]\n    ], [\n      [1, 1, 1],\n      [1, 0, ]\n    ], [\n      [1, 1],\n      [0, 1],\n      [0, 1]\n    ]\n  ],\n  J: [\n    [\n      [1, 0, 0],\n      [1, 1, 1]\n    ], [\n      [0, 1],\n      [0, 1],\n      [1, 1]\n    ], [\n      [1, 1, 1],\n      [0, 0, 1]\n    ], [\n      [1, 1],\n      [1, 0],\n      [1, 0]\n    ]\n  ],\n  O: [\n    [\n      [1, 1],\n      [1, 1]\n    ], [\n      [1, 1],\n      [1, 1]\n    ], [\n      [1, 1],\n      [1, 1]\n    ], [\n      [1, 1],\n      [1, 1]\n    ]\n  ],\n  T: [\n    [\n      [0, 1, 0],\n      [1, 1, 1]\n    ], [\n      [1, 0],\n      [1, 1],\n      [1, 0]\n    ], [\n      [1, 1, 1],\n      [0, 1, 0]\n    ], [\n      [0, 1],\n      [1, 1],\n      [0, 1]\n    ]\n  ],\n  Z: [\n    [\n      [1, 1, 0],\n      [0, 1, 1]\n    ], [\n      [0, 1],\n      [1, 1],\n      [1, 0]\n    ], [\n      [1, 1, 0],\n      [0, 1, 1]\n    ], [\n      [0, 1],\n      [1, 1],\n      [1, 0]\n    ]\n  ],\n  S: [\n    [\n      [0, 1, 1],\n      [1, 1, 0]\n    ], [\n      [1, 0],\n      [1, 1], \n      [0, 1]\n    ], [\n      [0, 1, 1],\n      [1, 1, 0]\n    ], [\n      [1, 0],\n      [1, 1], \n      [0, 1]\n    ]\n  ],\n  I: [\n    [\n      [1, 1, 1, 1]\n    ], [\n      [1], [1], [1], [1]\n    ], [\n      [1, 1, 1, 1]\n    ], [\n      [1], [1], [1], [1]\n    ]\n  ]\n}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/Tetris/block.tsx","import Utils from '@utils'\nimport blockMap from './block'\n\nconst keyCode = {\n  left: 37,\n  up: 38,\n  right: 39,\n  down: 40\n}\n\nconst couldMoveLeftOrRight = ({ width, block, rx, y, playboard, length }) => {\n  const leftBlockList: any[] = []\n  let couldMove = true\n  block.forEach((row, dy) => {\n    row.every((item, dx) => {\n      if (item) {\n        leftBlockList.push({ x: dx, y: dy })\n      }\n      return true\n    })\n  })\n  leftBlockList.every(item => {\n    const { x: ox, y: oy } = item\n    const nx = ox + rx\n    const ny = y + oy - length\n    if (ny >= 0 && ny < 20 && playboard[ny][nx]) {\n      couldMove = false\n    }\n    return couldMove\n  })\n  return couldMove\n}\n\nconst couldMoveFun = {\n  [keyCode.up]: ({ width, block, rx, y, playboard, length }) => {\n    let couldMove = true\n    block.every((row, dy) => {\n      row.every((_, dx) => {\n        const nx = dx + rx\n        const ny = y + dy - length\n        if (ny >= 0 && ny < 20 && playboard[ny][nx]) { couldMove = false }\n        return couldMove\n      })\n      return couldMove\n    })\n    return couldMove\n  },\n  [keyCode.down]: ({ width, block, rx, y, playboard, length }) => {\n    if (y === 21) { return false }\n    let couldMove = true\n    const bottomBlockList: any[] = []\n    for (let i = 0; i < width; i++) {\n      let l = block.length - 1\n      let next = true\n      while (l >= 0 && next) {\n        if (block[l][i]) {\n          bottomBlockList.push({ x: i, y: l })\n          next = false\n        }\n        l--\n      }\n    }\n    bottomBlockList.every(b => {\n      const { x: ox, y: oy } = b\n      const nx = ox + rx\n      const ny = y + oy - length\n      if (ny >= 0 && ny < 20 && playboard[ny][nx]) {\n        couldMove = false\n      }\n      return couldMove\n    })\n    return couldMove\n  },\n  [keyCode.left]: couldMoveLeftOrRight,\n  [keyCode.right]: couldMoveLeftOrRight,\n}\n\nexport default {\n  getCurrPosition: ({ x, y, cBlock, screen, rotate, moveTo }) => {\n    const playboard = Utils.clone(screen)\n    const block: number[][] = blockMap[cBlock][rotate]\n    const width = block[0].length\n    const min = 0\n    const max = 10 - width\n    const center = Math.floor((10 - width) / 2)\n    let length = block.length\n    let index = y\n    let rx = center + x\n    if (rx < min) {\n      rx = min\n      x = -center\n    }\n    if (rx > max) {\n      rx = max\n      x = width % 2 === 1 ? center + 1 : center\n    }\n    const cm = couldMoveFun[moveTo]({ width, block, rx, y, playboard, length })\n\n    if (cm) {\n      while (index > 0 && length > 0) {\n        let curr = --index\n        const row = block[length - 1]\n        curr = curr > 20 ? 20 : curr\n        for (let i = 0; i < 10; i++) {\n          if (i < row.length) {\n            const b = playboard[curr][rx + i]\n            if (!b) {\n              playboard[curr][rx + i] = row[i]\n            }\n          }\n        }\n        length--\n      }\n    }\n\n    return { playboard, x, screen, couldMove: cm }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/Tetris/tools.tsx","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js??ref--1-oneOf-0-2!../../../node_modules/postcss-loader/lib/index.js??postcss!../../../node_modules/less-loader/dist/cjs.js??ref--1-oneOf-0-4!./index.less\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {\"hmr\":false}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/Tetris/index.less\n// module id = 374\n// module chunks = 7 21","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".tetris-wrapper{width:100%;height:100%;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center;-ms-flex-item-align:center;align-self:center}.tetris-wrapper.mobile .tetris-screen{-webkit-transform:scale(.8);-ms-transform:scale(.8);transform:scale(.8)}.tetris-wrapper .tetris-screen{margin:0 auto;background-color:#9ead86;padding:10px;border-radius:8px}.tetris-wrapper .tetris-screen .row{height:16px}.tetris-wrapper .tetris-screen .row .item{width:20px;height:20px;padding:2px;border:2px solid #879372;margin:0 2px 2px 0;float:left}.tetris-wrapper .tetris-screen .row .item.block{border:2px solid #000}.tetris-wrapper .tetris-screen .row .item.block:after{background:#000}.tetris-wrapper .tetris-screen .row .item.full{border:2px solid #666}.tetris-wrapper .tetris-screen .row .item.full:after{background:#666}.tetris-wrapper .tetris-screen .row .item:after{content:\\\"\\\";display:block;width:12px;height:12px;background:#879372;overflow:hidden}.tetris-wrapper .btn-wrapper{text-align:center}.tetris-wrapper .btn-wrapper i{font-size:3rem;-webkit-transition:all .3s;-o-transition:all .3s;transition:all .3s;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}.tetris-wrapper .btn-wrapper i:active{color:#000;-webkit-transform:scale(1.2);-ms-transform:scale(1.2);transform:scale(1.2)}.tetris-wrapper .btn-wrapper .middle i:first-child{margin-right:2.5rem}\", \"\", {\"version\":3,\"sources\":[\"/Users/leonzhang/Documents/github/typescript/leon-ts-app/src/pages/Tetris/index.less\"],\"names\":[],\"mappings\":\"AAAA,gBACE,WAAY,AACZ,YAAa,AACb,oBAAqB,AACrB,aAAc,AACd,0BAA2B,AACvB,sBAAuB,AAC3B,qBAAsB,AAClB,uBAAwB,AAC5B,2BAA4B,AACxB,iBAAmB,CACxB,AACD,sCACE,4BAA8B,AAC1B,wBAA0B,AACtB,mBAAsB,CAC/B,AACD,+BACE,cAAe,AACf,yBAA0B,AAC1B,aAAc,AACd,iBAAmB,CACpB,AACD,oCACE,WAAa,CACd,AACD,0CACE,WAAY,AACZ,YAAa,AACb,YAAa,AACb,yBAA0B,AAC1B,mBAAoB,AACpB,UAAY,CACb,AACD,gDACE,qBAAuB,CACxB,AACD,sDACE,eAAiB,CAClB,AACD,+CACE,qBAAuB,CACxB,AACD,qDACE,eAAiB,CAClB,AACD,gDACE,WAAY,AACZ,cAAe,AACf,WAAY,AACZ,YAAa,AACb,mBAAoB,AACpB,eAAiB,CAClB,AACD,6BACE,iBAAmB,CACpB,AACD,+BACE,eAAgB,AAChB,2BAA4B,AAC5B,sBAAuB,AACvB,mBAAoB,AACpB,2BAA4B,AACxB,uBAAwB,AACpB,kBAAoB,CAC7B,AACD,sCACE,WAAY,AACZ,6BAA8B,AAC1B,yBAA0B,AACtB,oBAAsB,CAC/B,AACD,mDACE,mBAAqB,CACtB\",\"file\":\"index.less\",\"sourcesContent\":[\".tetris-wrapper {\\n  width: 100%;\\n  height: 100%;\\n  display: -ms-flexbox;\\n  display: flex;\\n  -ms-flex-direction: column;\\n      flex-direction: column;\\n  -ms-flex-pack: center;\\n      justify-content: center;\\n  -ms-flex-item-align: center;\\n      align-self: center;\\n}\\n.tetris-wrapper.mobile .tetris-screen {\\n  -webkit-transform: scale(0.8);\\n      -ms-transform: scale(0.8);\\n          transform: scale(0.8);\\n}\\n.tetris-wrapper .tetris-screen {\\n  margin: 0 auto;\\n  background-color: #9ead86;\\n  padding: 10px;\\n  border-radius: 8px;\\n}\\n.tetris-wrapper .tetris-screen .row {\\n  height: 16px;\\n}\\n.tetris-wrapper .tetris-screen .row .item {\\n  width: 20px;\\n  height: 20px;\\n  padding: 2px;\\n  border: 2px solid #879372;\\n  margin: 0 2px 2px 0;\\n  float: left;\\n}\\n.tetris-wrapper .tetris-screen .row .item.block {\\n  border: 2px solid #000;\\n}\\n.tetris-wrapper .tetris-screen .row .item.block:after {\\n  background: #000;\\n}\\n.tetris-wrapper .tetris-screen .row .item.full {\\n  border: 2px solid #666;\\n}\\n.tetris-wrapper .tetris-screen .row .item.full:after {\\n  background: #666;\\n}\\n.tetris-wrapper .tetris-screen .row .item:after {\\n  content: \\\"\\\";\\n  display: block;\\n  width: 12px;\\n  height: 12px;\\n  background: #879372;\\n  overflow: hidden;\\n}\\n.tetris-wrapper .btn-wrapper {\\n  text-align: center;\\n}\\n.tetris-wrapper .btn-wrapper i {\\n  font-size: 3rem;\\n  -webkit-transition: all .3s;\\n  -o-transition: all .3s;\\n  transition: all .3s;\\n  -webkit-transform: scale(1);\\n      -ms-transform: scale(1);\\n          transform: scale(1);\\n}\\n.tetris-wrapper .btn-wrapper i:active {\\n  color: #000;\\n  -webkit-transform: scale(1.2);\\n      -ms-transform: scale(1.2);\\n          transform: scale(1.2);\\n}\\n.tetris-wrapper .btn-wrapper .middle i:first-child {\\n  margin-right: 2.5rem;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?{\"importLoaders\":1,\"minimize\":true,\"sourceMap\":true}!./node_modules/postcss-loader/lib?{\"ident\":\"postcss\",\"plugins\":[null,null]}!./node_modules/less-loader/dist/cjs.js?{}!./src/pages/Tetris/index.less\n// module id = 513\n// module chunks = 7 21","import * as React from 'react'\nimport './index.less'\nimport Utils from '@utils'\nimport Tools from './tools'\nimport { Icon } from 'antd'\n\ninterface IStates {\n  row: number,\n  column: number,\n  screen: number[][],\n  playboard: number[][],\n  cBlock: string,\n  interval?: any,\n  y: number,\n  x: number,\n  rotate: number,\n  intervalTime: number,\n  couldMove: boolean\n}\n\ninterface IProps {\n  isMobile: boolean\n}\n\nconst keyCode = {\n  left: 37,\n  up: 38,\n  right: 39,\n  down: 40\n}\n\nconst blocks = ['I', 'L', 'J', 'T', 'Z', 'S', 'O']\n\nclass Tetris extends React.Component<IProps, IStates> {\n\n  componentWillMount() {\n    const row = 20\n    const column = 10\n    const screen = this.calculateScreen({ row, column })\n    document.addEventListener('keydown', this.keydown)\n    this.setState({\n      row, column, screen,\n      playboard: screen,\n      cBlock: blocks[Utils.random(0, 7)],\n      y: 0,\n      x: 0,\n      rotate: 0,\n      intervalTime: 500\n    })\n  }\n\n  reset = (f?) => {\n    this.setState({\n      cBlock: blocks[Utils.random(0, 7)],\n      y: 1,\n      x: 0,\n      rotate: 0,\n      screen: this.clearRow(this.state.playboard)\n    }, f)\n  }\n\n  clearRow = playboard => {\n    const result = Utils.clone(playboard).map(row => row.map(item => item ? 2 : 0))\n    playboard.forEach((row, i) => {\n      if (row.every(item => item)) {\n        result.splice(i, 1)\n        result.unshift(new Array(10).fill(0))\n      }\n    })\n    return result\n  }\n\n  keydown = e => this.doMove(e.keyCode)\n\n  doMove = code => {\n    const { x: cx, y: my, screen, cBlock, row, rotate } = this.state\n    let playboard = [[]]\n    let x = cx\n    switch(code) {\n      case keyCode.left:\n        x = cx - 1\n        const { \n          playboard: lp, \n          x: lx, \n          couldMove: lc \n        } = Tools.getCurrPosition({ x, y: my ? my - 1 : 20, cBlock, screen, rotate, moveTo: keyCode.left })\n        if (lc) { \n          x = lx \n          playboard = lp\n          this.setState({ playboard, x })\n        }\n        return\n      case keyCode.right:\n        x = cx + 1\n        const { \n          playboard: rp, \n          x: rx, \n          couldMove: rc \n        } = Tools.getCurrPosition({ x, y: my ? my - 1 : 20, cBlock, screen, rotate, moveTo: keyCode.right })\n        if (rc) { \n          x = rx \n          playboard = rp\n          this.setState({ playboard, x })\n        }\n        return\n      case keyCode.down: \n        if (my > row) { return }\n        const { couldMove } = Tools.getCurrPosition({ x, y: my, cBlock, screen, rotate, moveTo: keyCode.down })\n        if (!couldMove) {\n          this.isDropComplete(true)\n          this.reset(this.newInterval)\n        } else {\n          this.newInterval()\n        }\n        return\n      case keyCode.up:\n        let r = rotate\n        r = r >= 3 ? 0 : r + 1\n        const { \n          playboard: up, \n          couldMove: uc \n        } = Tools.getCurrPosition({ x: cx, y: my ? my - 1 : 20, cBlock, screen, rotate: r, moveTo: keyCode.up })\n        if (uc) {\n          playboard = up\n          this.setState({ playboard, rotate: r })\n        }\n        return\n      default:\n        \n    }\n  }\n\n  newInterval = () => {\n    const { interval } = this.state\n    if (interval) { clearInterval(interval)}\n    this.doMovePlayboard()\n  }\n\n  componentDidMount() {\n    this.doMovePlayboard()\n  }\n\n  doMovePlayboard = () => {\n    const { x: ix, y: iy, intervalTime } = this.state\n    const interval = setInterval(() => {\n      const { x, y } = this.state\n      this.movePlayboard({ x, y })\n    }, intervalTime)\n    this.movePlayboard({ x: ix, y: iy})\n    this.setState({ interval })\n  }\n\n  movePlayboard = ({ x, y }) => {\n    const { screen, cBlock, rotate } = this.state\n    const { playboard, couldMove } = Tools.getCurrPosition({ x, y, cBlock, screen, rotate, moveTo: keyCode.down })\n    if (couldMove) {\n      this.setState({ playboard, y: y + 1 }, this.isDropComplete)\n    } else {\n      this.isDropComplete(true, this.reset)\n    }\n  }\n\n  isDropComplete = (res?, f?) => {\n    const { y } = this.state\n    if (y === 0 || res) {\n      this.setState({ \n        screen: Utils.clone(this.state.playboard).map(row => row.map(item => item ? 2 : 0))\n      }, f)\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.state.interval) { clearInterval(this.state.interval) }\n    document.removeEventListener('keydown', this.keydown)\n  }\n\n  // state \n  // 0: empty, 1: full\n  calculateScreen = ({ row: r, column: c }) => {\n    const result: number[][] = []\n    for (let i = 0; i < r; i++) {\n      const row: number[] = []\n      for (let j = 0; j < c; j++) { row.push(0) }\n      result.push(row)\n    }\n    return result\n  }\n\n  renderPlayboard = () => this.state.playboard.map((r, i) => (\n    <div className='row' key={i}>\n      { r.map((c, j) => <div key={j} className={`item ${c ? c === 1 ? 'block' : 'full' : ''}`}/>) }\n    </div>\n  ))\n\n  \n  render() {\n    const { isMobile } = this.props\n    return (\n      <div className={`tetris-wrapper ${isMobile ? 'mobile' : ''}`}>\n        <div className='tetris-screen'>\n          { this.renderPlayboard() }\n        </div>\n        <div className='btn-wrapper'>\n          <Icon type='ts-app icon-up-circle' onClick={Utils.handle(this.doMove, keyCode.up)}/>\n          <div className='middle'>\n            <Icon type='ts-app icon-left-circle' onClick={Utils.handle(this.doMove, keyCode.left)}/>\n            <Icon type='ts-app icon-right-circle' onClick={Utils.handle(this.doMove, keyCode.right)}/>\n          </div>\n          <Icon type='ts-app icon-down-circle' onClick={Utils.handle(this.doMove, keyCode.down)}/>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Utils.connect({\n  component: Tetris,\n  mapStateToProps: state => ({\n    isMobile: state.common.isMobile\n  })\n})\n\n\n// WEBPACK FOOTER //\n// ./src/pages/Tetris/index.tsx"],"sourceRoot":""}